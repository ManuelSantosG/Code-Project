
a=1.4;
b=0.3;

%Initial condition
x0=[0,0];

%Number of Iterations
n=10000;

%Sequence of images
Seq=zeros(2,n);
Seq(:,1)=x0;
% 
% for i=2:n
%     v=Seq(:,i-1);
%     [h1,h2]=henon(v(1),v(2),a,b);
%     Seq(:,i)=[h1,h2];
% end
% 
% plot(Seq(1,:),Seq(2,:),'.','MarkerSize',4)
% hold on
% 
% 
% 
% v=Seq(:,n);
% [h1,h2]=henon(v(1),v(2),a,b);
% TmSeq=[Seq(:,2:n),[h1,h2]'];

XE=[0.905791937075620,2.22044604925031e-16,8.93143162353204e-32;2.45612217823257,0.485693289071097,4.54254689419287e-14;2.76589138372743,1.38642639904284,9.22872889219661e-16;0.773878546848265,0.856109261521476,1.49685819295087e-13;1.60361240998109,1.20078075007897,1.30451205393456e-15;0.886712820039936,1.64321412299185,2.22911966663020e-14;1.78461281320333,0.736506315056946,5.78329051315052e-13;1.88649220458651,1.65823838668100,1.26988697335406e-13;1.28272157602640,0.835376479229001,4.62449523119801e-13;1.58573051497977,1.48419958590950,6.38378239159465e-15;1.17125548216857,1.11069496645864,5.85989590184965e-13;1.28246797184267,1.37099581291120,5.68989300120393e-15;1.29963831887880,1.09681360880858,1.29234123402711e-12;1.21138292673467,1.48594200049035,1.47162837471626e-12;1.51982712749055,0.786316318680523,1.08260275744065e-12;1.70238094731838,1.58246850821128,2.07975824062512e-12;1.26615128920566,0.936017541486191,7.12971348626468e-15;1.42214301484492,1.50641754934440,7.58448859272676e-13;1.37706906050105,0.907702404023356,1.49880108324396e-15;1.45234371656570,1.57620872212967,1.02556851899749e-14;1.48027329707895,0.745571539982779,9.97008031689006e-13;1.77698117153213,1.51954018051004,1.08246744900953e-14;1.03353925392397,1.17524846922839,1.10325637514563e-12;1.36554049449636,1.19447921798477,1.06581410364015e-14;1.11300823392597,1.45182099195911,2.90845819650443e-12;1.54350046223543,0.790207212866773,9.75608482889356e-15;1.69867708211334,1.59928189267993,4.91186258333443e-12;1.30901504311992,0.881137326227437,2.08583150751451e-12;1.50574072893154,1.52190922662258,2.40779618465581e-14;1.32779618836487,0.940248798056108,2.25626461958228e-12;1.40281507787049,1.54989202393782,2.64538391192559e-12;1.47259784296039,0.777099619604105,2.06730466079108e-12;1.71262801261473,1.54787419417199,4.78916906132554e-12;1.17398575033920,1.04660358032859,9.52016243616072e-15;1.32143760899786,1.41573421061333,7.72576447261031e-13;1.32291936767504,1.03696187497555,8.38912272982384e-15;1.26131122664935,1.53560426915179,3.26849658449646e-12;1.55991684838055,0.710052238886485,1.99519567534168e-12;1.86846528803464,1.51630141667126,3.97910870919560e-14;0.915792494892832,1.24680642661957,1.24900090270330e-14;1.47253510391764,1.00902209542177,2.56533683185012e-12;1.24526325722988,1.65737387939666,3.74958397664216e-12;1.76701600050306,0.547043274200324,1.67599267797414e-12;2.25737213990835,1.33844674246810,2.17603712826531e-14;0.290414802754847,1.20303681501696,6.23924523157626e-13;1.67568011126939,0.835677870597162,5.08459940817829e-12;1.62115190593768,1.71890818221182,9.64509028200666e-12;1.64325203840571,0.476055987441826,2.60321625367155e-12;2.31106213826116,1.17377713500781,6.43998743221630e-14;0.0608982309690016,2.10869071010538,1.68129399291672e-14;0.563150132463547,1.01426693381151,2.07092676340892e-12;1.57811368956127,1.03962468230501,3.25850457727483e-14;1.14822140696462,1.73413843661246,7.19602155641042e-12;1.81091274259212,0.712137981564942,4.64181471038216e-12;1.95177020839373,1.63464352085265,1.15921439114430e-11;1.15976889296004,0.959922075666986,4.02450295311496e-12;1.41623425653636,1.43183512490108,7.35783656224953e-12;1.25553251862282,1.08622822176159,3.31124017094453e-14;1.24616550103946,1.45722809623614,6.33826324758502e-12;1.44956257231345,0.877788756714205,1.29063426612674e-15;1.50622795092936,1.61086281157500,8.78896955214259e-12;1.50341851779381,0.690578040862454,3.75281576647790e-12;1.88974983426803,1.46564741253730,1.00028735294799e-11;0.751976866522682,1.37704218895325,3.76260134160589e-12;1.66291334763642,0.746972925680368,4.48434345212689e-12;1.82209458033968,1.61290283749286,1.06352149309430e-11;1.22443618809834,0.937296722085686,4.15592560365496e-12;1.42932662335056,1.47762147457277,5.67423191766281e-12;1.31927059790194,0.987760626495338,4.73440731063590e-12;1.33028551481244,1.54428789232078,6.97172874986052e-12;1.52158597237206,0.736413851757201,7.18869408444789e-15;1.80505203158095,1.52993927106000,7.58837437331295e-14;1.02724862907289,1.16829303116063,1.67921232474555e-14;1.36841256529545,1.19754732976839,1.99319727389735e-14;1.11005094060972,1.45072950215511,5.72565606038467e-12;1.54412510099454,0.790432517153694,4.39241698568793e-12;1.69831827190009,1.59984890091376,9.84316794738760e-12;1.31067200008961,0.879071172893548,6.16173778666962e-15;1.50919952062918,1.52217052818269,2.68951527715444e-14;1.32498822885441,0.942601864125731,4.51280679492072e-12;1.39950068902721,1.54821275418086,5.59310930903223e-12;1.47231823389204,0.778878360880936,4.16645884460110e-12;1.70900508750749,1.54943786009230,9.59576862413769e-12;1.18151795321430,1.03914788007876,4.45757319944562e-12;1.32425169009125,1.42517178446718,5.59274848654923e-15;1.33402247180602,1.01836407382071,1.52655665885959e-14;1.28113462397513,1.54986717111537,6.81268930158296e-12;1.56865083811219,0.690798943972729,3.92433308071816e-12;1.90933881925742,1.49511756340935,7.77988784506078e-14;0.805865186015726,1.32154380133134,7.60421586809557e-12;1.59115893585456,0.833214438842610,9.62291357708978e-12;1.61252103857645,1.66675493136966,1.14487412605779e-13;1.53354175856716,0.604785996032774,6.71971853161146e-12;2.05651510890091,1.35773526094730,5.72597524950425e-14;0.158470626448609,1.54257241999855,1.83189227676017e-12;1.70434134104308,0.825239763647550,1.03111963412061e-14;1.65230456300452,1.72525120744547,1.93670635084686e-11;1.63377783143687,0.471943449165828,1.43644818262345e-12;2.31261715049383,1.16392233244208,1.20889409593872e-13;0.239318238148704,2.18034163404614,3.77305131582517e-12;0.571110346115429,1.00622184590611,1.31006316905768e-14;1.57674959175259,1.04841329084587,1.20117700508349e-11;1.13095720222997,1.73102099545717,1.42305993378056e-11;1.80797126535905,0.718456012986963,9.41485778227502e-12;1.93641366481160,1.64282958048983,1.33595079443438e-11;1.19673813434638,0.922707363986486,7.71605002114484e-15;1.45586392330917,1.45764794061434,2.87785073549429e-12;1.25837934642186,1.06102069566943,4.56024107364783e-14;1.26630567732965,1.47431351637808,8.14903700074865e-14;1.45885215788553,0.854824220263841,9.01440033729273e-12;1.55308291064356,1.60307556550745,1.54314339084749e-11;1.44834908140368,0.749012695324903,7.87820156333829e-12;1.76340741126087,1.50699901937444,1.68273173173361e-11;1.01867532935176,1.19775154384447,8.83612627511354e-12;1.38147097636984,1.15493847350123,1.15568665748356e-11;1.11405027049824,1.50672243162518,1.21609389225341e-11;1.61842619840471,0.687567091399966,3.53120310769839e-14;1.93225737135583,1.51278061936142,6.59750032383499e-14;0.826980050653776,1.29208329053263,7.12621628373711e-12;1.55642386928335,0.885663545632835,1.00084385223909e-11;1.49084953013645,1.68435700411309,1.77574066562158e-11;1.66558492689802,0.507347702896847,5.95535426528571e-12;2.27410039611569,1.23668212401321,2.03807942744660e-11;0.468631807223599,1.09012224401704,3.70568853380604e-12;1.60879284912658,0.946103742954371,1.23512311489549e-14;1.35052453175079,1.74936344014337,1.11605169550444e-13;1.83507884731540,0.581035139436867,7.72711061802767e-12;2.23009613028752,1.42255996404778,1.84756931975727e-11;0.203036871669995,1.35283131714047,1.08496545081493e-12;1.71229534188476,0.804511865832329,2.59167687310935e-14;1.70416700910537,1.70752506495178,1.71376524082945e-11;1.55148501806865,0.541505801685357,3.54266616042764e-12;2.16943229378160,1.26315218030724,4.94292107244831e-14;0.336483933706494,1.15807577422418,2.79558320936957e-12;1.65540517905398,0.865607377541999,1.16295861829485e-14;1.54565136023556,1.73298621986492,1.90591709081644e-11;1.73253078111365,0.452603696489690,5.58336710199114e-12;2.38878906501022,1.15047336911282,2.27454166612517e-12;0.340574187861852,2.28064233043262,5.60852753128671e-12;0.636696648366267,0.946993333055396,4.29128954593239e-12;1.57458138056376,1.11119245219503,5.57887069874141e-15;1.01830237021637,1.70082994354590,1.25527158112426e-11;1.79331195093062,0.740587009832666,9.21102083495384e-12;1.88032208695856,1.66820029753262,1.86604620644459e-11;1.31377485675821,0.796478405340688,7.54205031761046e-12;1.65533554710693,1.47720542435906,1.77335784945498e-11;1.07845493952599,1.18752955022350,7.15816295127070e-14;1.33759701851593,1.21622076249517,1.14342979529170e-11;1.13686303876533,1.40149979160490,1.13965989423370e-11;1.46077746680320,0.909562113962001,9.59395410338182e-12;1.44149239634561,1.63324354640864,1.70170544322446e-11;1.59874104954792,0.592145550541677,6.86177503705920e-12;2.10406583272279,1.36124481469996,2.07530242990472e-11;0.0670434897618744,1.42061303566409,2.06473727004664e-13;1.70255069232844,0.822554428905184,1.37667655053519e-14;1.65841171827810,1.72145352152222,2.05438999145713e-11;1.61997700631098,0.482552291353829,5.66351132658127e-12;2.29057972428953,1.17984468023194,1.95178595507883e-11;0.541966862557938,1.03107723275500,3.97587518463638e-12;1.58316712765696,1.01890126840487,1.49047441055927e-14;1.18997726871589,1.74098338971738,1.06081810002934e-13;1.81810335801400,0.694797869034900,9.14915365690661e-12;1.99307988905911,1.61103664593110,2.86823516326695e-14;1.05188071954219,1.05993853469691,1.42386102908176e-14;1.37274749714483,1.31454399663869,1.30309790735694e-11;1.15142619161831,1.28446891292030,1.07599484877596e-11;1.32913346263196,1.13932735137243,8.52096171399808e-14;1.16225000782154,1.47707179136148,1.20479320964151e-11;1.54325282201964,0.771424699248564,8.62221405384389e-12;1.73829004095555,1.57985124564040,8.32206525913648e-12;1.22428513489741,0.973612861881684,8.58721329721063e-12;1.37981299821269,1.47630181626394,1.37788391807447e-11;1.36348607877267,0.946867671028285,1.27522992166007e-13;1.38447672767610,1.57591150073048,3.13267467522138e-11;1.53478884850799,0.696469969844220,1.55097601428622e-11;1.88773653938741,1.48733732627091,4.07796574286579e-11;0.812696173727622,1.32777548518599,1.56902130177272e-11;1.59290129648184,0.827814567961904,9.03443986288721e-14;1.62499240246847,1.66298390519382,3.90117903259490e-11;1.51532809163979,0.624156292602353,1.36273214934590e-11;2.01582259970722,1.37974470028793,2.50712783866902e-11;0.317064327004960,1.55386700453061,3.08267300574983e-13;1.71614401922808,0.820478514695137,2.04128103309387e-11;1.66658575632420,1.72704535120204,4.14080020272323e-11;1.62679299825555,0.472569506235321,1.08987888158829e-11;2.30842267200471,1.16337761987903,3.42226247340705e-14;0.250427411831011,2.18024482816003,6.55725473919233e-15;0.568140186681109,1.00842388576009,8.24326024106981e-12;1.57731483177963,1.04566408422845,2.38240122074629e-11;1.13625299021855,1.73215680400345,3.04201108747293e-14;1.80879449277582,0.716858482805562,1.23508980820475e-11;1.94033607009805,1.64081054892397,2.06053230034087e-11;1.18756674279483,0.932058737788619,1.60674251681314e-11;1.44487208362426,1.45204774025289,1.84571524730615e-11;1.25989286742886,1.06460369576543,1.32727162593937e-13;1.26215925270102,1.47360715493157,1.32057559332210e-13;1.46115901565276,0.853115796823681,1.72691897674243e-11;1.55668144561908,1.60338495635772,3.17978421371379e-11;1.44590328134226,0.750981505190412,6.58639809358874e-14;1.75909245855891,1.50778625393261,3.80351861117845e-11;1.02569364138000,1.19247312381598,1.76787751104968e-11;1.37506646648634,1.16723759640687,4.57099635919889e-14;1.11306261016506,1.48932344788173,2.39530270618182e-11;1.59468487671706,0.718084223472760,1.65974456400875e-11;1.86265171601647,1.54290811401088,3.82613385419006e-12;0.995217333798049,1.17365642463465,1.16583184078811e-11;1.39005350243596,1.16598229075623,4.97657470788226e-14;1.10146914084103,1.50324031351335,2.39219061226592e-11;1.62157690305914,0.688035588705926,4.26741975090295e-14;1.93240019127738,1.51482527205001,2.16993090162987e-13;0.832735789423873,1.28726474076334,1.53502870137157e-11;1.54960134413645,0.895853086309468,2.01714062120217e-11;1.46792190861760,1.68585180862131,3.57802121264683e-11;1.68543819053045,0.501300960084847,8.55010506839449e-14;2.29288991030345,1.23098771135036,5.77807246493478e-12;0.492244278976586,1.07476532319217,7.65275343095340e-12;1.59987049281118,0.966425788334619,2.24222827804876e-11;1.30393136083958,1.74909476442261,4.27435864480685e-15;1.83462865473255,0.619780919236217,1.65230051862864e-11;2.15616073340832,1.49223569431969,1.89868398781101e-11;0.486104739604542,1.38293478937663,7.64138752273880e-13;1.72540420962902,0.752767682261831,7.07767178198537e-15;1.82880271863483,1.65152600963103,3.81028125717720e-11;1.31640147857658,0.815236846443546,1.55881002550373e-11;1.62200381445050,1.49176710480682,2.08781880672859e-11;1.14690245701797,1.12268208128109,1.86982651584344e-11;1.29347108757334,1.34096190980666,2.48862597196364e-11;1.25501477491558,1.16539291474484,2.11178019515756e-11;1.20773848861244,1.38950191162194,1.90518434362019e-11;1.38859713307592,0.992968573550244,2.85327317328665e-14;1.30014167197921,1.59545115800712,3.00099389782815e-11;1.63254381071622,0.606761720613311,4.74874306544137e-12;2.09180068843046,1.39675661936290,4.22982759928914e-11;0.224536741204782,1.49238308589381,5.72653036101656e-13;1.71467839308594,0.815984475478876,2.02033112461919e-11;1.67714912286713,1.72142218995664,3.98114041733066e-11;1.60511759836698,0.489938070676179,1.14423054364821e-11;2.27275804385005,1.18934065143206,3.92796212222990e-11;0.519253818514820,1.04864369370479,5.13009773550621e-14;1.58984100886461,0.996771922400870,6.33104679792496e-14;1.23665810158807,1.74625180756812,3.13766651549585e-11;1.82617716295231,0.669262942310062,3.43752803999564e-14;2.05146076492404,1.57336563586542,2.81608070196171e-13;0.876108396991890,1.19628769607462,7.34221017317793e-12;1.47001934126830,1.04911148513528,2.22721008302784e-11;1.17671501909804,1.64685434778738,1.26537669231652e-13;1.77992285177764,0.571868291629767,1.08732467474226e-13;2.22008570430648,1.38778367290627,1.28272392707629e-13;0.170913417191680,1.29706585001584,2.35061536207892e-14;1.70239203464387,0.813694029257320,6.47849829338298e-14;1.67972098578730,1.71203225830273,3.86754794856614e-11;1.58118924305920,0.515644561562257,1.38326849974391e-14;2.22290683814009,1.22806005178574,3.94450236362864e-11;0.434739334322328,1.10651478570512,2.46608289344863e-14;1.62090290203427,0.922854022993660,2.16623628757073e-11;1.40529532474916,1.74782469940638,2.50896525777478e-13;1.82633937645414,0.533809006868557,8.01823885066000e-14;2.30928081124467,1.33124680969181,4.46969683487453e-11;0.358081344049190,1.17270709752871,3.05780400999822e-12;1.65656753939534,0.858012874616739,9.49240686054509e-14;1.56415681163756,1.72746211352247,3.91028875945665e-11;1.70669621336997,0.455188733289733,1.10670153596892e-11;2.37215083351265,1.14960957626476,1.54168778437880e-13;0.356821627099833,2.27048315950958,1.17886950201651e-11;0.624722230252242,0.958030427357605,8.61753723935266e-12;1.57353215828757,1.10041584018938,7.77156117237610e-14;1.03651169577896,1.70658577142857,2.56568100098775e-11;1.79525388467715,0.738506930955420,1.46948841983630e-11;1.88583820921713,1.66617648708736,3.83451881358354e-11;1.30383915438719,0.807521726878940,1.53131951563523e-11;1.63503373102721,1.47939471357975,8.52982962040727e-12;1.10644143540517,1.16513587415459,1.86209103691937e-11;1.31513332610005,1.26534466908742,1.32585331602542e-11;1.17298247534132,1.31346575772727,2.23639635456296e-11;1.33531974787135,1.10869356095135,2.95319324550292e-14;1.17916252614718,1.50681632448895,2.57899812616813e-11;1.57463219367375,0.720927341025524,1.63828256516396e-11;1.85085743930560,1.53700747219807,3.84147158527526e-11;0.992814508218677,1.18156774987623,1.29313226793215e-13;1.39354960731445,1.15463084796125,6.80566714095221e-14;1.10476496622810,1.51715888053121,4.94049245958195e-14;1.63896729786514,0.666695850009118,1.59003435418192e-11;1.98104163572126,1.49165961336528,4.29954682967804e-11;0.701609098130375,1.36159304743482,4.93806384671558e-14;1.66929242286161,0.753086270559544,1.82292791972571e-11;1.81055072361556,1.62379503549232,4.12609738043024e-11;1.26319759428554,0.893273361422437,1.38188072096312e-14;1.48983885845334,1.49625246859818,2.52181331372725e-11;1.29414451478537,0.994403236621104,1.22749033160119e-13;1.32912892603213,1.52469740085320,2.78691097976846e-11;1.48908581651246,0.783581171052009,5.53307399897562e-14;1.70243686451958,1.56304608925262,3.10831638206111e-11;1.22043221264959,0.994187536546380,8.18234369148740e-14;1.35533205323633,1.46999293739797,2.86112522562831e-11;1.37532540440492,0.940747511853390,1.87055509970335e-11;1.39290600857701,1.58333832742478,3.16779935616296e-11;1.54173006009121,0.683647974474450,1.52590544366671e-11;1.91469494213528,1.47363517579220,4.08946626562212e-11;0.739083633571219,1.37213225740708,1.46601897288434e-11;1.66384919694222,0.749422569023089,1.80381543035679e-11;1.81699943869566,1.61646223339965,2.76026146384112e-11;1.23845641597779,0.921976750030388,8.93313201189017e-14;1.44884434391065,1.48580567422487,2.84362047797693e-11;1.31497360703800,0.984580930743389,1.05943032124856e-13;1.33635255164945,1.54143559046631,2.99640867673645e-11;1.51187251783161,0.747783691484325,2.58985541345957e-14;1.77979822126717,1.53794586935896,3.30220295552408e-11;1.07639214763615,1.12776450601103,1.76371972582245e-11;1.33666935609240,1.27940686017422,2.23183693748297e-11;1.16065416734245,1.31074046244142,1.36029798536441e-11;1.34313878263914,1.10278571915826,2.15018280957935e-11;1.17917719751726,1.51740006385995,2.60110821770354e-11;1.59047719679252,0.699871677276622,1.60847030139522e-11;1.89830407959124,1.51708051560843,4.03818471716999e-11;0.881359489783455,1.26293447936007,1.60808866223050e-11;1.50408789649227,0.961681876419403,7.86315457190767e-14;1.32964265073455,1.67886556208994,2.53685961126848e-14;1.75933808313934,0.520075254938096,1.32921243456430e-11;2.29872596907489,1.28610516548386,2.84786083604160e-13;0.420795414224532,1.12847390209760,6.86754819678725e-12;1.62991403036077,0.901926678061686,1.44488587761060e-13;1.45569987835508,1.74233647297362,3.67109190269055e-11;1.80260336372989,0.491218275018702,1.27896326342081e-11;2.36656510186529,1.24248684790392,3.24952842412074e-11;0.543504117307833,1.04315800564616,8.22113210841025e-12;1.58271479846107,1.01087078540396,2.03619343608352e-11;1.20745807500889,1.74107194411798,3.05481751006198e-11;1.82185253381952,0.681717337199215,8.17956813392584e-14;2.02303682881579,1.59183250688313,3.95500715510977e-11;0.963631197896458,1.13265423969009,1.36321787191918e-11;1.40397546243939,1.18662482621866,2.39159833430314e-11;1.08149463223064,1.49340072640822,2.34886832206627e-11;1.62064503060800,0.695944941483269,1.63931090924052e-11;1.91613018679351,1.52538764589693,1.72280800736502e-11;0.883163296060753,1.25250902492706,1.24115717703432e-11;1.49604902957873,0.977970213977496,2.07808492636019e-11;1.29822314656072,1.67519438127426,9.22040221951193e-14;1.76899447672472,0.530601656254397,1.35391212130465e-11;2.28610732921083,1.30855874112687,1.43995926293883e-13;0.372169746883097,1.15836981651398,6.25788310060216e-12;1.64931005373753,0.869917892683771,4.17414436348906e-11;1.53448618265458,1.73259589500894,7.65036922700801e-11;1.73931879151829,0.454946680406883,2.29062463441565e-11;2.38884317355857,1.15655732806590,8.03951558103755e-11;0.268899279852891,2.25990681072239,1.04111164134224e-13;0.633934693531197,0.950837598552618,1.73428355010330e-11;1.57379313110892,1.10817436963349,3.91783827602410e-13;1.02363867678479,1.70211218217578,5.06255037890924e-11;1.79407025068759,0.739370014840354,1.65248370542770e-11;1.88340992096007,1.66683752718981,8.23031920393902e-11;1.30762985186111,0.803462043974249,1.69933511706688e-13;1.64246087032176,1.47874725663285,4.53422022150818e-11;1.09658331409688,1.17298854173261,1.22110654920959e-13;1.32255407047777,1.24836468615723,3.63799546043708e-11;1.15825477871385,1.34501995333844,5.71127589665821e-11;1.37850638897801,1.03837271354607,4.14726586406289e-11;1.23443499475256,1.57849827128567,5.63432633882144e-11;1.64882873326556,0.612824195874875,7.92421683826206e-15;2.08741939177242,1.41244678683720,6.61054856687660e-11;0.288720141524732,1.48779572742556,1.24607754670159e-11;1.72169472089724,0.809007309673924,4.04708835888279e-11;1.69576734264523,1.71774397732733,8.17571843558795e-11;1.58178834496966,0.507983048404544,2.32089486518206e-11;2.23497299247582,1.21495187638814,5.96377114359115e-13;0.461062197319283,1.08952159420035,1.44982428840201e-11;1.61066668317692,0.944133355396678,2.86826118411909e-13;1.35503862143018,1.74996048825839,3.02355362968854e-13;1.83513889064870,0.578427050762823,2.27054486323652e-13;2.23492095470567,1.41777683398390,9.20555021100000e-11;0.196391631122728,1.34061067367993,6.32272012524027e-14;1.71038567422090,0.805843473268817,1.46170298087611e-11;1.70049498730035,1.70794818979235,8.42166336667560e-11;1.55536242747674,0.538182270006307,7.46624984060418e-15;2.17636645562661,1.25880107238183,6.60348165038016e-11;0.349758223675794,1.15192979988996,1.16821274875889e-11;1.65131319006122,0.871396725908155,1.51723356101030e-11;1.53114115686727,1.73499972415186,7.68568819697890e-11;1.74682404625648,0.454907217601499,2.26966936185073e-11;2.39270170624295,1.15818447951946,2.07153738607246e-13;0.244482984695823,2.25573817709436,1.60308433194700e-11;0.636015857374542,0.949196308719242,1.74326386659374e-11;1.57389935931890,1.10991055512808,5.07412722949852e-11;1.02079023116156,1.70109997262301,5.04679215085346e-11;1.79381753035515,0.739531713093696,1.06553654788399e-13;1.88294355134895,1.66694597370936,8.89943674309279e-11;1.30830958500194,0.802745800203486,1.33698607740484e-13;1.64377773689742,1.47862952143688,4.19778101168333e-11;1.09482235300698,1.17438349791488,2.07195371970670e-14;1.32393564137029,1.24530775140958,4.67378358237625e-11;1.15583740727065,1.35058157762986,4.44938495769431e-11;1.38640031219622,1.02577604566672,2.88657986402541e-13;1.24933351997057,1.58829734475436,3.52269324821464e-11;1.65506677118365,0.601674503158228,2.87023529943475e-11;2.11033586687405,1.39660781673949,1.86616069819401e-11;0.192952285620150,1.47250252376083,7.93809462606987e-15;1.71308797792399,0.815775604167930,4.03562946948988e-11;1.67727052432449,1.72029941529377,8.14349698785577e-11;1.60238082839386,0.492812945410570,2.27041302425235e-11;2.26720655622963,1.19375611829492,5.58324220190087e-13;0.510569602651190,1.05525052655380,1.55755824904347e-11;1.59268229149653,0.988386329379324,3.11313474998798e-14;1.25486900553150,1.74766869654533,1.34003919072256e-13;1.82904107097257,0.657529772982181,3.48166218078205e-11;2.07732095108777,1.55504605758374,8.32365010250413e-11;0.789072546304022,1.25199769373698,2.37601049946079e-11;1.54825307121758,0.919651594026285,2.03864702896794e-13;1.41494162019031,1.69680622215877,6.95142832185525e-11;1.74294297851025,0.494264475908013,2.48973272554132e-11;2.33174586011686,1.23297347304636,8.35636768115045e-11;0.523941434000167,1.05468086387793,1.16444631714785e-11;1.58885725206185,0.994132718340995,4.57877208370761e-11;1.24278648645706,1.74534328101109,7.94332238873707e-11;1.82743573063259,0.662508135191668,3.48085346353957e-11;2.06622216333487,1.56270978336493,3.69128477784031e-11;0.826078592263872,1.22939440107765,2.29467556067675e-11;1.51472966720245,0.972279416919528,2.34308128455041e-11;1.30576294228194,1.68826855095536,6.61276589042359e-14;1.78463552189035,0.532197912728898,2.45498066320238e-14;2.29113796565327,1.31608565490617,8.27153597351971e-11;0.364634531815620,1.16426911504315,1.22722665363284e-11;1.65261618683159,0.864674380893614,3.63598040564739e-15;1.54755051479385,1.73050330863391,7.76482489417418e-11;1.72560991773201,0.453861049745834,2.27214011494503e-11;2.38350101885760,1.15134568658883,7.83745846000272e-11;0.333402923331982,2.27403399348190,6.31300567377480e-14;0.632395609044099,0.951241628043070,1.74985026468733e-11;1.57402322038209,1.10724440339577,2.83148504642838e-13;1.02498821916179,1.70287904714371,2.96401791999301e-13;1.79405534421677,0.739725591740699,3.83952869498216e-11;1.88258449229875,1.66733559621990,7.76382569345202e-11;1.30961795407975,0.801131933339208,3.03315289551520e-11;1.64673553159896,1.47822787216641,5.15796849676065e-11;1.09057242625243,1.17785215360693,1.37972966385291e-13;1.32735356164612,1.23777077768125,2.32911467890062e-11;1.15024041771190,1.36409589148482,2.69506639227757e-13;1.40581975596824,0.995024346052675,4.06310124434484e-11;1.29131471715702,1.60819258040669,6.00885452506361e-11;1.66075566595684,0.582099035093557,2.79356537902231e-11;2.14771380365684,1.36608530502597,2.43294898116808e-11;0.101793907368183,1.32202789152185,2.09415818019920e-14;1.70134684602834,0.819949243626896,1.34544042573737e-11;1.66443053519286,1.71805543385807,8.24906670748860e-11;1.60725440389888,0.493050130643315,2.28419089198795e-11;2.26906895907379,1.19544533102349,4.36845004614383e-13;0.510519498771422,1.05562622741175,1.55194884721155e-11;1.59272432546084,0.988083119270090,4.48115711204622e-11;1.25554574720422,1.74766645782286,4.62851978966228e-13;1.82914878983468,0.656975263287815,3.49610757011121e-11;2.07852112780852,1.55415969046031,3.28984062214488e-11;0.784854373255525,1.25450606301602,2.81557693826429e-11;1.55205680382965,0.913920616754989,4.12342868183480e-11;1.42755978779110,1.69677915836541,7.00231123085260e-11;1.73505064452185,0.491881902633173,1.43773881688958e-14;2.33153440024059,1.22641415505886,8.28860868828940e-11;0.531271256140102,1.04821596143136,1.49602552568240e-14;1.58640559826344,1.00198801473157,1.63521973739478e-13;1.22591844312772,1.74388809985186,6.22101085923088e-11;1.82472777107702,0.672967313497641,2.43794567866829e-13;2.04297776301797,1.57884203516501,2.73437383846442e-11;0.902415902136648,1.17805922658504,3.07123632081741e-11;1.44796166041299,1.09046662895468,4.58920956791786e-11;1.12771323847168,1.61061767725195,5.23820986586543e-11;1.75498034472553,0.582557269585770,2.97097485502107e-11;2.18911239170877,1.39865271773341,1.01071928604313e-13;0.147771774103800,1.35762417009998,1.37279076994901e-13;1.70835542906610,0.812273310018841,4.01286226470177e-11;1.68457078379289,1.71385860577593,8.20822854130654e-11;1.58158738382193,0.513079986801329,2.33593283605060e-11;2.22704890078490,1.22373810284316,3.73506781059518e-13;0.443749268951323,1.10085037275646,1.41757716676238e-11;1.61739469029421,0.929882910626426,4.36494312916480e-11;1.38856596900928,1.74875228631434,7.01683988690860e-11;1.83050751224733,0.548583659720553,2.54302134905515e-12;2.28598570465315,1.36056961583230,4.62310745241723e-13;0.284287796684430,1.21687509832643,4.45277495431107e-14;1.68063229610633,0.828612685410866,1.36474165302047e-13;1.63910076089324,1.71494028683624,2.98424479572290e-13;1.61993972611754,0.490563147550450,2.29195586121111e-11;2.27861815855196,1.19427794522821,7.59011742346161e-11;0.519586097319040,1.04941643114855,3.80390163812194e-14;1.58978640935057,0.996330995536573,4.58319215912439e-11;1.23765565702970,1.74618473638094,6.24741092192238e-11;1.82637432021329,0.668331646166351,4.53803661315533e-15;2.05351432186286,1.57191347897872,9.22401599545708e-11;0.869297109264474,1.20094136715162,2.90004045083725e-11;1.47594820434186,1.03842939465642,2.41619224627954e-13;1.19193403899068,1.65466050833549,1.75914838251856e-13;1.78376404767833,0.568737848658245,2.94064356198831e-11;2.22751586652125,1.38335178545045,8.32869606615105e-11;0.183225992440655,1.28222517416397,6.80977496614332e-12;1.70013629946675,0.814714677372239,4.02053390580193e-11;1.67673821762053,1.71184853933395,2.62956323382468e-13;1.58312006870252,0.514670301833782,2.36115155205496e-11;2.22526468670153,1.22691659840993,1.13397902179457e-11;0.438239757985110,1.10445160628109,5.90749671403046e-12;1.61956823790185,0.925458225046979,1.10255138352500e-11;1.39908323556090,1.74818002840760,7.08452740916243e-11;1.82803142609040,0.539240417533330,2.85864665272584e-11;2.30087865862246,1.34210126992455,1.94033608624800e-11;0.331068188860816,1.18868980690534,6.24318305386673e-14;1.66614497911153,0.845243715293787,4.08037631460800e-11;1.59641736376146,1.72213520346690,4.70345984382448e-13;1.66998532288407,0.464621410992893,2.24690266392713e-11;2.34054824714598,1.15898571630607,7.53817156265435e-11;0.273144261855367,2.21756467006139,1.76047683375646e-11;0.595933113976269,0.985165725717624,1.41553435639707e-15;1.57352252528733,1.07256484590201,4.86564677437684e-11;1.08573832086413,1.72037152621437,9.46603906371024e-14;1.80136745095817,0.730032929107609,3.82026771328370e-11;1.90758157102444,1.65686481540580,8.70996677559965e-11;1.26055663203797,0.855257715077004,3.11573822298072e-11;1.55248218411389,1.48065072036120,6.13246675662538e-11;1.20009154799372,1.09048938187275,1.27897692436818e-13;1.27558648308968,1.40969635518063,4.62750948670987e-11;1.35620737380974,1.00935920548290,2.62304067355501e-13;1.28552986353828,1.56879863077782,4.06619182768964e-14;1.59721716242376,0.652608428002428,7.65359997600967e-14;1.99300759692831,1.45368341707979,4.94424501340518e-11;0.570317518413133,1.44003425656752,1.78265735506500e-12;1.74199845936758,0.733804023507336,3.70573571828459e-11;1.87724011787648,1.63405997746370,8.81369421890099e-11;1.22754223430496,0.909986640503977,3.22773960337308e-11;1.46876773185671,1.47659659934663,6.07450478806726e-11;1.27886529664827,1.02582419322389,3.81320808262586e-11;1.29436793501953,1.50535163242944,5.54661316876093e-11;1.48513184422501,0.803692371294904,2.60458508059835e-11;1.66060635910840,1.57939501836590,7.41398609171995e-11;1.29962584801230,0.910158479328976,2.13190576303646e-13;1.45750733358332,1.52487276481722,1.04246472565350e-13;1.37860681851912,0.889784357629489,2.36755060001315e-13;1.48538604320802,1.57054895384137,6.69263602870451e-11;1.44130328691172,0.787660572227613,3.27952248690977e-11;1.68647578934222,1.54069566513978,5.53143642001430e-11;1.18490387578422,1.04528357608725,3.59465755772614e-11;1.31728282802660,1.42483030845527,5.41076107529737e-11;1.33993874885105,1.01290313150420,3.57488535301931e-11;1.28648788460264,1.55568482016377,3.04867242562068e-13;1.57441001882441,0.681193718810122,9.28701560098943e-14;1.93001973400575,1.48464424748045,8.33049488765947e-11;0.749059491126221,1.35539619174954,2.14155082556289e-13;1.64593740632191,0.769363526653373,3.66036714827267e-11;1.76777953519979,1.63156919986421,8.06576264111847e-11;1.32184347586026,0.834162444912386,3.11468073554977e-11;1.58830803774423,1.50685184304007,6.79429845718005e-11;1.21465149444237,1.05393785093498,1.55868373763468e-13;1.29512151289964,1.44358852924174,5.14710080112835e-11;1.38765030561741,0.950560012732587,3.81078502087462e-11;1.37314035968535,1.59356556203297,6.34645669350675e-11;1.57573155032827,0.646548729986942,2.96064561755571e-11;1.99665351240703,1.43610761257468,8.30027435672065e-11;0.512513388671790,1.47152370811650,1.91300100760294e-13;1.74682210876411,0.758548662692469,3.84074855253047e-11;1.82255483717625,1.66984507415553,7.95694343747044e-11;1.36711863497382,0.747882154920342,2.97369004420567e-11;1.75021814694553,1.46453874412411,7.00577651446821e-11;0.935229818025735,1.29201043354303,3.17228188162488e-11;1.49240873729022,0.954695291706767,2.20795326466572e-11;1.34596811489469,1.66910911947139,2.78166378819833e-13;1.73357244673002,0.518967721104649,2.59045770945043e-11;2.28796669464000,1.27680065666893,6.03336824944734e-13;0.424861460421589,1.12381897054509,1.38328792864684e-11;1.62766786265344,0.906588102647121,2.41640041309665e-13;1.44440454362091,1.74362258929249,7.28842819430753e-11;1.80914792993668,0.499769361733358,4.96963581397836e-14;2.35643940821215,1.26084408935670,1.28702604129671e-13;0.511452915579703,1.06943904018258,8.24948442890161e-12;1.59378607385686,0.977802747477806,2.88685741978156e-13;1.27871120869619,1.74700120370584,6.47808638329361e-11;1.83227285115546,0.636544471135836,3.20021786848201e-14;2.12172885895212,1.52061087808325,4.12025136231620e-11;0.624001814792754,1.33634546618373,9.23983112244287e-14;1.67622036463412,0.764805443702175,1.16670562100296e-13;1.78643355030394,1.64181670638972,7.79301068121185e-11;1.32999776556954,0.815053607479077,2.69417821385787e-11;1.62306536484144,1.49949330683122,7.06490421720218e-11;1.16198427736134,1.10354238517422,1.79298745989209e-11;1.29128272710055,1.36926380950551,4.53653850596147e-11;1.28935214350284,1.10822862226789,6.96347493556182e-12;1.20918221341809,1.46939812634272,5.09058351028102e-11;1.49698458364446,0.821267011133144,6.40182351574481e-14;1.62573580061101,1.60122498117305,7.45440653648899e-11;1.38061207980996,0.814178256686212,3.26470933620371e-11;1.62814627386648,1.52810590188784,6.18443352085052e-11;1.21800585283076,1.03086921293022,3.06879886086131e-11;1.31545145131452,1.45677160335697,5.55370940208411e-11;1.38987364994433,0.937527823834162,2.62886934443429e-13;1.39612957728671,1.59294670689135,6.40699576726078e-11;1.55693051089556,0.662016990752537,1.25427446207027e-13;1.96096905029474,1.45055976798084,8.27300450367829e-11;0.608666709006773,1.43735459409296,1.48818457557098e-13;1.73883099401560,0.723791132745216,7.61890550649014e-14;1.89837674758063,1.61853846104610,8.78729311537541e-11;1.16568271938503,0.975510251258078,3.00585389911845e-11;1.39601416324054,1.43380859928668,5.01082508819195e-11;1.27874181952556,1.06334122829885,3.92711974050997e-11;1.25341591326537,1.48923995851776,5.41346967253276e-11;1.49229093363524,0.810006465396570,2.14397943842926e-13;1.64858017557938,1.58898494573742,6.64599070221428e-11;1.33260087153129,0.870853805744326,6.51978471211123e-14;1.52242708724438,1.53268906474315,6.53368817382649e-11;1.33305904453747,0.925425999758927,3.57724405652959e-11;1.42677900562964,1.55104572127615,6.34089586393216e-11;1.45450158924818,0.793279354985040,3.34877819918589e-11;1.67726142781903,1.55300410862242,5.80264447602730e-11;1.22286332862610,1.00235933969184,3.56400464696094e-11;1.34472720709215,1.46984173933224,5.46732242812098e-11;1.38461112899780,0.931811552098082,3.83859610764148e-14;1.40734520379221,1.58806081017757,6.39722719242286e-11;1.53908746344487,0.681506166474330,3.04907488146711e-11;1.91797557546133,1.46961875851043,8.11838374303875e-11;0.723514680247733,1.38226046827319,1.45163395193215e-13;1.67786489105314,0.737621713918666,1.82034942675102e-13;1.84722150743902,1.60822218271280,6.09891026570608e-11;1.18778612224433,0.971164591565050,1.10925157947861e-13;1.39418805413939,1.45034211888508,5.75312887607371e-11;1.30699592199632,1.02285570137668,3.87512660848799e-11;1.28616529690915,1.52789859242598,5.59300383784489e-11;1.52847284231864,0.744155329336646,1.20584098262100e-13;1.79113201829570,1.54224370554111,6.30977770033070e-11;1.07457673792436,1.12447043892045,9.46465128492946e-15;1.33829941699796,1.28106095816136,1.21985754830689e-14;1.16012615580076,1.30956606807108,4.32223701274381e-11;1.34253274908138,1.10438153098299,1.33421051984328e-13;1.17816211868036,1.51579849620258,5.16136994255234e-11;1.58877434878684,0.702460119464901,8.24895707296491e-14;1.89256071736931,1.51974875940432,6.75806077765628e-11;0.895861107847390,1.25291122192530,2.29841701226974e-11;1.48866776256788,0.986130966191031,4.25786073066092e-11;1.28387587323999,1.67024243449361,1.80390424819876e-13;1.76823500770238,0.535048843462110,2.74879875805656e-11;2.27829971085989,1.31662525793524,6.75487443757561e-13;0.350639981084740,1.17043077729137,1.19204091042491e-11;1.65705578470790,0.858765584590982,4.08141576091481e-11;1.56240981415656,1.72839255127794,7.81035514041406e-11;1.71011924384692,0.454310398476143,2.23021948131397e-11;2.37511273874704,1.14870260013964,5.50930967513352e-11;0.364789263718980,2.27519753633260,2.40646669258382e-11;0.627332253169217,0.955442825885742,1.73828104688134e-11;1.57376840510534,1.10288387791736,5.04114944233081e-11;1.03227056093753,1.70532597166493,5.10707864886939e-11;1.79476341372423,0.739113139965520,3.85006748704342e-11;1.88425906769990,1.66680471927601,7.71432639989911e-11;1.30681508906800,0.804194014905441,3.05264286071250e-11;1.64110902884674,1.47879666940864,5.04968011849627e-11;1.09823974178381,1.17173310505696,1.57873714101697e-13;1.32127561379236,1.25116648047766,2.29977703547490e-11;1.16055725900333,1.33986903022993,4.49539572233704e-11;1.37124952097634,1.05000547849380,4.16892909083089e-11;1.22195318958764,1.56860733103825,5.54624679516280e-11;1.64110973094188,0.624979349763425,6.64017452134402e-14;2.06180903843693,1.42891069441199,8.09511537663843e-11;0.386753278305930,1.48092851225477,9.48130463029884e-14;1.73350866688176,0.792393398685477,3.98744925966810e-11;1.73886400207659,1.70518111838654,8.02587718506942e-11;1.51861442015040,0.569600631568565,2.51538373463589e-11;2.11044498998232,1.29815567941287,7.96327587204715e-11];


Seq=zeros(2,649);
Seq(1,:)=XE([1:649],1);
Seq(2,:)=XE([1:649],2);

TmSeq=zeros(649);
TmSeq(1,:)=XE([2:650],1);
TmSeq(2,:)=XE([2:650],2);

plot(Seq(1,:),Seq(2,:),'.','MarkerSize',4)
%title('Poincaré Section L-84')
hold on

n=649;
%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%
% Coarse Graining Boxes

nx=10;
ny=20;

xx=linspace(0,3,nx);
yy=linspace(0,2.5,ny);

%%%%%%%%%%%%%%%%%%%%
for i=1:nx
    for j=1:ny
        plot(xx(i),yy(j),'+','color','b')
        hold on
    end
end
%%%%%%%%%%%%%%%%%%%%
com_n=(nx-1)*(ny-1);

B=zeros(nx-1,ny-1,4);

for i=2:nx
    for j=2:ny
        B(i-1,j-1,1)=xx(i);
        B(i-1,j-1,2)=yy(j);
        B(i-1,j-1,3)=xx(i-1);
        B(i-1,j-1,4)=yy(j-1);
    end
end

Counter=zeros(nx-1,ny-1);
P=zeros(com_n,10);
for k=1:n
    Point=Seq(:,k);
    for i=1:nx-1
        for j=1:ny-1
            if Point(1)<=B(i,j,1) && Point(1)>B(i,j,3) && Point(2)<=B(i,j,2) && Point(2)>B(i,j,4)
                    Counter(i,j)=Counter(i,j)+1;
                    P(j+(ny-1)*mod(i-1,ny-1),Counter(i,j))=k;
            end
        end
    end
end

Bn=zeros(com_n,4);
for i=1:nx-1
    for j=1:ny-1
        Bn(j+(ny-1)*mod(i-1,ny-1),:)=B(i,j,:);
    end
end

% Counter=zeros(nx-1,ny-1);
% for k=1:n;
%     Point=Seq(:,k);
%     for i=1:nx-1;
%         for j=1:ny-1;
%             if Point(1)<=B(i,j,1) & Point(1)>B(i,j,3) & Point(2)<=B(i,j,2) & Point(2)>B(i,j,4);
%                     Counter(i,j)=Counter(i,j)+1;    
%             end
%         end
%     end
% end


Cn=zeros(com_n,1);
for i=1:nx-1
    for j=1:ny-1
        CCC=j+(ny-1)*mod(i-1,ny-1);
        Cn(CCC)=Counter(i,j);
    end
end



numerator=zeros(com_n,com_n);
for i=1:com_n
    for j=1:com_n
        if Cn(i)~=0
            for k=1:Cn(i)
                m=P(i,k);
                h=TmSeq(:,m);
                if h(1)<=Bn(j,1) && h(1)>Bn(j,3) && h(2)<=Bn(j,2) && h(2)>Bn(j,4)
                    numerator(i,j)=numerator(i,j)+1;
                end
            end
        end
    end
end

CCn=[];
iupa=[];
for i=1:com_n
    if Cn(i)~=0
        iupa=[iupa i];
        CCn=[CCn Cn(i)];
    end
end

new_n=length(CCn);
numerator_n=zeros(new_n);


q=1;
for i=1:com_n
    if Cn(i)~=0
        numerator_n(q,:)=numerator(i,iupa);
        q=q+1;
    end
end

TOp=zeros(new_n);
for i=1:new_n
    for j=1:new_n
        TOp(i,j)=numerator_n(i,j)/CCn(i);
    end
end


TrM=zeros(com_n,com_n);
for i=1:com_n
    for j=1:com_n
        if Cn(i)~=0
            TrM(i,j)=numerator(i,j)/Cn(i);
        end
    end
end

[vv,ll,ww]=eig(TrM);
lambda=diag(ll);
index=find(real(lambda<1+0.0005 & real(lambda>1-0.0005)));
Dv=ww(:,index);

hold off

Dv=(1/sum(Dv))*Dv;

figure(2)
plot(Dv)
%title('Invariant Density')
% for i=1:com_n
%     if abs(Dv(i))>0
%         p1=0.5*(Bn(i,1)+Bn(i,3));
%         p2=0.5*(Bn(i,2)+Bn(i,4));
%         plot(p1,p2,'s','MarkerSize',10,'MarkerFaceColor','r')
%         %plot(p1,p2,'s','MarkerSize',2,'color','r')
%     end
% end






